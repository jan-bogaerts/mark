
import React, { Component } from 'react';
import { Tabs } from 'antd';
import cybertronService from '../../../services/cybertron_service/CybertronService';
import dialogService from '../../../services/dialog_service/DialogService';
import themeService from '../../../services/Theme_service/ThemeService';
import ResultsViewTab from './results_view_tab/ResultsViewTab';

const { TabPane } = Tabs;

/**
 * ResultsView component
 * This component is used to display the results generated by the transformers
 */
class ResultsView extends Component {
  constructor(props) {
    super(props);
    this.state = {
      transformers: [],
      theme: themeService.getCurrentTheme(),
    };
  }

  componentDidMount() {
    this.getTransformers();
  }

  /**
   * Fetches the transformers from the cybertron service
   */
  getTransformers = () => {
    try {
      const transformers = cybertronService.transformers;
      this.setState({ transformers });
    } catch (error) {
      dialogService.showErrorDialog('Error fetching transformers', error);
    }
  };

  /**
   * Renders the tabs for each transformer
   */
  renderTabs = () => {
    const { transformers } = this.state;
    return transformers.map((transformer) => (
      <TabPane tab={transformer.name} key={transformer.id}>
        <ResultsViewTab transformer={transformer} />
      </TabPane>
    ));
  };

  render() {
    const { theme } = this.state;
    return (
      <div className={`results-view ${theme}`}>
        <Tabs defaultActiveKey="1" tabPosition="left">
          {this.renderTabs()}
        </Tabs>
      </div>
    );
  }
}

export default ResultsView;
