
import React, { Component } from 'react';
import { List, Typography } from 'antd';
import ThemeService from '../../services/Theme_service/ThemeService';

/**
 * LogWindow component
 * This component is used to display log messages generated by the application.
 */
class LogWindow extends Component {
  constructor(props) {
    super(props);
    this.state = {
      logMsgs: [],
    };
    this.handleLogMsg = this.handleLogMsg.bind(this);
  }

  /**
   * Component did mount lifecycle method
   * Registers the event handler for receiving log messages.
   */
  componentDidMount() {
    window.electron.onLogMsg(this.handleLogMsg);
  }

  /**
   * Component will unmount lifecycle method
   * Removes the event handler for receiving log messages.
   */
  componentWillUnmount() {
    window.electron.removeOnLogMsg(this.handleLogMsg);
  }

  /**
   * Event handler for log messages
   * Adds the received log message to the state.
   * @param {string} msg - The log message
   */
  handleLogMsg(msg) {
    this.setState(prevState => ({
      logMsgs: [...prevState.logMsgs, msg],
    }));
  }

  render() {
    const theme = ThemeService.getCurrentTheme();
    return (
      <div className={`log-window ${theme}`}>
        <List
          size="small"
          bordered
          dataSource={this.state.logMsgs}
          renderItem={item => <List.Item><Typography.Text>{item}</Typography.Text></List.Item>}
          style={{ overflow: 'auto' }}
        />
      </div>
    );
  }
}

export default LogWindow;
